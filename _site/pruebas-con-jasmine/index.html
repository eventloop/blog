<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Responsive Bootstrap App Landing Page Template">
  <meta name="keywords" content="Kane, Bootstrap, Landing page, Template, App, Mobile, Android, iOS">
  <meta name="author" content="Mizanur Rahman">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Pruebas con Jasmine</title>

  <link rel="icon" href="/images/favicon.png">
  <link rel="apple-touch-icon" href="/images/favicon.png">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

  <link href='http://fonts.googleapis.com/css?family=Roboto:100,300,100italic,400,300italic' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="/stylesheets/styles.css">
  <link rel="stylesheet" href="/stylesheets/colors/yellow.css">

  <link rel="stylesheet" href="/stylesheets/responsive.css">
  <link rel="stylesheet" href="/stylesheets/pygment_trac.css">
</head>
<body>
  <div class="navbar navbar-inverse bs-docs-nav navbar-fixed-top sticky-navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#kane-navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/"><img src="/images/js-logo.png" alt=""></a>
      </div>
      <div class="navbar-collapse collapse" id="kane-navigation">
        <ul class="nav navbar-nav navbar-right main-navigation">
          <li><a href="/">Home</a></li>
          <li><a href="/#services">Eventos</a></li>
          <li><a href="/blog">Artículos</a></li>
          <li><a href="#newsletters">Newsletters</a></li>
          <li><a href="/#contact">Contáctanos</a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="app-brief blog">
    <div class="container">
      <div class="col-md-8 col-md-push-2 left-align">
        <div class="post fadeInLeft animated">
          <h1 class="post-title">Pruebas con Jasmine</h1>
          <div class="post-content">
            <h3 id="qu-es-jasmine">¿Qué es Jasmine?</h3>

<p>Jasmine es un framework de Desarrollo Dirigido por Comportamientos (<em>Behavior Driven Development</em>) para realizar pruebas unitarias (<em>Unit Testing</em>) de código JavaScript. Jasmine puede ser ejecutado en el navegador o sin él utilizando un <em>headless browser</em> como PhantomJS, CasperJS o ZombieJS para automatizar mejor las pruebas. También no requiere de un DOM, por lo que es posible hacer pruebas en cualquier Javascript Engine, como Rhino o V8 (Node.js).</p>

<p>En Jasmine encontraremos las siguientes características:</p>

<ol>
  <li>Sintáxis natural para poder probar comportamientos con BDD</li>
  <li>Soporte para pruebas asincrónicas</li>
  <li>Personalización de diferentes componentes como <em>reporters</em>, <em>equalities</em> y <em>matchers</em></li>
  <li>Mocking</li>
  <li>Stubing</li>
  <li>Spying</li>
</ol>

<h3 id="por-qu-jasmine">¿Por qué Jasmine?</h3>

<p>BDD está relacionado con el comportamiento de nuestro desarrollo, a diferencia de TDD (<em>Testing Driven Development</em>) que sólo está centrado en probar su funcionamiento. Con BDD podemos describir de manera más precisa lo que nuestro desarrollo debe hacer, por eso es muy útil para tener claridad de cómo empezar a desarrollar y para saber qué es lo que debemos y no debemos hacer. Si deseas conocer más sobre BDD, puedes revisar la publicación <a href="http://dannorth.net/introducing-bdd">Introducing BDD</a> de Dan North.</p>

<p>Cada día es más necesario hacer pruebas de nuestro código, para asegurar su estabilidad y hacerlo escalable. Actualmente existen muchas librerías y frameworks en diferentes lenguajes de programación que nos ayudan a lograrlo. Con Jasmine podemos hacer fácilmente nuestras pruebas, con una sintáxis idiomática inspirada en ScrewUnit, JSSpec, JSpec y RSpec (Ruby).</p>

<h3 id="jasmine-en-el-navegador">Jasmine en el navegador</h3>

<p>Para descargar Jasmine puedes clonar el repositorio o sólo descargar la <a href="https://github.com/pivotal/jasmine/tree/master/dist">standalone version</a> más reciente desde Github:</p>

<p><code>bash
$ wget https://github.com/pivotal/jasmine/raw/master/dist/jasmine-standalone-2.0.3.zip
$ unzip jasmine-standalone-2.0.3.zip
$ rm jasmine-standalone-2.0.3.zip
$ rm spec/* src/*
</code>
Después tendremos una estructura de archivos como la siguiente:</p>

<pre><code>.
  ├─ MIT.LICENSE
  ├─ SpecRunner.html
  ├─ lib
  │  └─ jasmine-2.x.x
  │     ├─ boot.js
  │     ├─ console.js
  │     ├─ jasmine-html.js
  │     ├─ jasmine.css
  │     ├─ jasmine.js
  │     └─ jasmine_favicon.png
  ├─ spec
  └─ src
</code></pre>

<p>Puedes no seguir la convención de estructura de archivos que Jasmine ofrece y adaptarlo fácilmente a cualquier tipo de proyecto. Lo único que debes saber es que necesitas un <em>runner</em> como <strong>SpecRunner.html</strong> que deberá cargar la librería <code>jasmine.js</code> y todo lo necesario dentro de <code>lib/jasmine-2.x.x</code>. Por defecto, <strong>SpecRunner.html</strong> nos cargará también el <em>reporter</em> predeterminado <code>jasmine-html.js</code> y el archivo de inicialización <code>boot.js</code> que será ejecutado antes de las pruebas unitarias y que puede personalizarse para modificar el funcionamiento de Jasmine o para añadir un <em>reporter</em> personalizado.</p>

<p>Dentro del <em>runner</em> necesitamos incluir los archivos de pruebas (especificaciones) y los archivos que serán probados (código en producción), ambos tipos de archivos pueden ubicarse dentro de <code>/spec</code> y <code>/src</code>, respectivamente.</p>

<h3 id="cmo-funciona">¿Cómo funciona?</h3>

<p>Las funciones principales de Jasmine para hacer pruebas son:</p>

<ul>
  <li><code>describe(a, b)</code> donde “a” es la descripción de nuestra <em>suite</em> y “b” la función anónima donde se incluirá toda la <em>suite</em> o serie de especificaciones.</li>
  <li><code>it(a, b)</code> donde “a” es la descripción de la especificación y “b” la función anónima donde se incluirán las expectativas (expectations) que debe cumplir la aplicación.</li>
  <li><code>expect(a)</code> donde “a” es un valor que será probado, mediante argumentos en cadena (<em>method chaining</em>). Por ejemplo: <code>expect(true).not.toBe(false)</code>.</li>
  <li><code>beforeAll(a)</code> donde “a” será la función que se ejecutará antes de iniciar las pruebas.</li>
  <li><code>afterAll(a)</code> donde “a” será la función que se ejecutará después de iniciar las pruebas.</li>
  <li><code>beforeEach(a)</code> donde “a” será la función que se ejecutará antes de cada prueba.</li>
  <li><code>afterEach(a)</code> donde “a” será la función que se ejecutará después de cada prueba.</li>
</ul>

<h3 id="el-hola-mundo-de-jasmine">El “¡Hola mundo!” de Jasmine</h3>

<p>Supongamos que quieres saber si tu aplicación saluda al mundo. Primero necesitas hacer la primera prueba para que tu aplicación no sepa de qué estás hablando. Crea el archivo <code>/spec/HolaMundoSpec.js</code> y añade lo siguiente:</p>

<p><code>js
describe('Hola mundo', function () {
  it('debe saludar al mundo', function () {
    expect(saludar()).toEqual('¡Hola Mundo!');
  });
});
</code></p>

<p>La prueba fallará porque no encontrará la función <code>saludar</code> y no podrá evaluarla. El siguiente paso es superar la prueba con las expectativas que se han generado, es decir, que la función <code>saludar</code> debe arrojar una cadena igual a “¡Hola Mundo!”. Para pasar esta prueba, crea el archivo <code>/src/HolaMundo.js</code> y añade lo siguiente:</p>

<p><code>js
var saludar = function () {
  return '¡Hola Mundo!';
};
</code></p>

<p>¿Qué pasa si ahora queremos que nuestra aplicación salude en diferentes idiomas? Nosotros tendremos que modificar nuestra prueba y añadir más especificaciones.</p>

<p>```js
describe(‘Hola mundo’, function () {
  it(‘debe saludar al mundo en español’, function () {
    expect(saludar()).toEqual(‘¡Hola Mundo!’);
  });</p>

<p>it(‘debe saludar al mundo en inglés’, function () {
    expect(saludar(‘inglés’)).toEqual(‘Hello World!’);
  });</p>

<p>it(‘debe saludar al mundo en alemán’, function () {
    expect(saludar(‘alemán’)).toEqual(‘Hallo Welt!’);
  });</p>

<p>it(‘debe saludar al mundo en francés’, function () {
    expect(saludar(‘francés’)).toEqual(‘Bonjour Monde!’);
  });
});
```</p>

<p>Nuestra prueba fallará en todas las especificaciones, excepto en idioma español. Ahora, para pasar la prueba, debemos modificar la función <code>saludar</code> con el fin de que nos arroje un saludo en diferentes idiomas dependiendo del argumento que pasemos.</p>

<p>```js
var saludar = function (lenguaje) {
  var saludo = ‘¡Hola Mundo!’;</p>

<p>switch (lenguaje) {
    case ‘inglés’:
      saludo = ‘Hello World!’;
      break;
    case ‘alemán’:
      saludo = ‘Hallo Welt!’;
      break;
    case ‘francés’:
      saludo = ‘Bonjour Monde!’;
      break;
  };</p>

<p>return saludo;
};
```</p>

<p>Finalmente, nuestras pruebas han pasado, pero ahora quisiéramos mejorarlas y crear un <a href="http://jasmine.github.io/2.0/custom_matcher.html">custom matcher</a> para verificar un saludo, porque nos parece que <code>expect(a).toEqual(b)</code> no tiene la suficiente claridad que necesitamos.</p>

<p>```js
describe(‘Hola mundo’, function () {</p>

<p>beforeEach(function () {
    jasmine.addMatchers({
      toBeGreeting: function () {
        return {
          compare: function (saludo) {
            var resultado = {};
            resultado.pass = saludo.match(/hola|hello|hallo|bonjour/i);
            return resultado;
          }
        }
      }
    });
  });</p>

<p>it(‘debe saludar al mundo en español’, function () {
    expect(saludar()).toBeGreeting();
  });</p>

<p>it(‘debe saludar al mundo en inglés’, function () {
    expect(saludar(‘inglés’)).toBeGreeting();
  });</p>

<p>it(‘debe saludar al mundo en alemán’, function () {
    expect(saludar(‘alemán’)).toBeGreeting();
  });</p>

<p>it(‘debe saludar al mundo en francés’, function () {
    expect(saludar(‘francés’)).toBeGreeting();
  });
});
```</p>

<p>Puedes ver este ejemplo en <a href="https://github.com/markotom/javascriptmx/tree/master/hacer-pruebas-de-bdd-tdd-con-jasmine/example">Github</a>.</p>

          </div>

          <div class="meta">
            <div class="author clearfix">
              <a href="http://github.com/markotom" class="author-avatar pull-left">
                
                  <img src="http://gravatar.com/avatar/340cf435956320a68d9d1e6a82ba13c3" class="img-circle" alt="">
                
              </a>
              
              <div class="author-info">
                <div class="author-name"><strong>Marco Godínez</strong></div>
                <div class="author-description text-muted">Frontend Web Developer</div>
                <a href="http://github.com/markotom">http://github.com/markotom</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      <ul class="social-icons">
        <li><a href="//facebook.com/javascriptmx">
          <?xml version="1.0" encoding="utf-8"?> <!-- Generator: IcoMoon.io --> <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000"><g><path d="M 26,0L 6,0 C 2.686,0,0,2.686,0,6l0,20 c0,3.314, 2.686,6, 6,6l 20,0 c 3.314,0, 6-2.686, 6-6L 32,6 C 32,2.686, 29.314,0, 26,0z M 20.136,15.998L 17.514,16l-0.002,9.6L 13.914,25.6 L 13.914,16 l-2.4,0 L 11.514,12.692 l 2.4-0.002L 13.91,10.742C 13.91,8.042, 14.642,6.4, 17.82,6.4l 2.648,0 l0,3.31 L 18.812,9.71 c-1.238,0-1.298,0.462-1.298,1.324L 17.51,12.69l 2.976,0 L 20.136,15.998z"></path></g></svg>
        </a></li>
        <li><a href="//twitter.com/javascriptmx">
          <?xml version="1.0" encoding="utf-8"?> <!-- Generator: IcoMoon.io --> <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000"><g><path d="M 26,0L 6,0 C 2.686,0,0,2.686,0,6l0,20 c0,3.314, 2.686,6, 6,6l 20,0 c 3.314,0, 6-2.686, 6-6L 32,6 C 32,2.686, 29.314,0, 26,0z M 23.96,12.408c 0.008,0.17, 0.012,0.34, 0.012,0.51c0,5.206-3.962,11.208-11.208,11.208c-2.224,0-4.294-0.652-6.038-1.77 c 0.308,0.036, 0.622,0.056, 0.94,0.056c 1.846,0, 3.544-0.63, 4.892-1.686c-1.724-0.032-3.178-1.172-3.68-2.736 C 9.12,18.036, 9.364,18.060, 9.62,18.060c 0.36,0, 0.708-0.048, 1.038-0.138C 8.856,17.56, 7.498,15.968, 7.498,14.060c0-0.016,0-0.032,0-0.050 c 0.532,0.296, 1.138,0.472, 1.784,0.494C 8.226,13.798, 7.53,12.592, 7.53,11.226c0-0.722, 0.194-1.398, 0.532-1.98 c 1.942,2.384, 4.846,3.952, 8.12,4.116C 16.114,13.074, 16.080,12.772, 16.080,12.464c0-2.174, 1.764-3.938, 3.94-3.938 c 1.132,0, 2.156,0.478, 2.876,1.244c 0.898-0.178, 1.742-0.506, 2.502-0.956c-0.294,0.92-0.918,1.692-1.732,2.18 c 0.796-0.094, 1.556-0.308, 2.262-0.62C 25.4,11.162, 24.73,11.856, 23.96,12.408z"></path></g></svg>
        </a></li>
      </ul>
      <p class="copyright">
        ©2015 JavascriptMX, todos los derechos reservados.
      </p>

    </div>
  </footer> 

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-53721608-1', 'auto');
    ga('send', 'pageview');
  </script>

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

</body>
</html>
